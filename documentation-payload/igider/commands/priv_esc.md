# 🛡️ `priv_esc` Command – Local Privilege Escalation Enumerator

The `priv_esc` command automates the enumeration of misconfigurations and vulnerabilities that could lead to privilege escalation on **Linux and Windows** systems.

Originally built for Linux environments, it has been extended to support comprehensive privilege escalation assessments on Windows as well.

This command is useful for red team operators and penetration testers to identify common privilege escalation vectors on compromised systems.

---

## ✅ Usage Syntax

```bash
priv_esc
```

> No arguments required. The command performs an extensive local enumeration and returns structured results.

---

## 🔍 What It Checks

### 🔧 Linux Checks

| Category               | Description                                                                 |
|------------------------|-----------------------------------------------------------------------------|
| **Sudo Privileges**    | Checks for passwordless or unrestricted `sudo` permissions.                 |
| **Privileged Groups**  | Detects if the user is part of sensitive groups like `sudo`, `docker`, etc. |
| **Critical File Perms**| Finds world/group-writable or readable sensitive files (`/etc/shadow`, etc.)|
| **SUID/SGID Binaries** | Identifies risky or custom SUID/SGID binaries in system paths.              |
| **Capabilities**       | Uses `getcap` to identify binaries with dangerous capabilities.             |
| **Kernel Info**        | Flags vulnerable or outdated kernel versions (e.g., Dirty COW).             |
| **Cron Permissions**   | Checks for writable or user-owned cron jobs or crontab files.               |
| **Environment Vars**   | Finds risky environment variables like `LD_PRELOAD`, `PATH`, etc.           |
| **Process Info**       | Lists root-owned processes related to services.                             |
| **Network Services**   | Lists processes listening on all interfaces.                                |
| **World-Writable Files**| Finds such files in `/etc`, `/usr`, `/opt`, `/tmp`, etc.                   |
| **SSH Key Exposure**   | Detects accessible or writable private keys and `authorized_keys`.          |
| **Docker Socket**      | Checks for access to Docker socket and group.                               |
| **Mount Points**       | Detects NFS/SSHFS mounts that may have lax permissions.                     |

### 🪟 Windows Checks

| Category                  | Description                                                                 |
|---------------------------|-----------------------------------------------------------------------------|
| **Admin/UAC Check**       | Detects if running as admin and the status of UAC.                         |
| **User Privileges**       | Enumerates dangerous privileges like `SeDebugPrivilege`, `SeImpersonatePrivilege`, etc. |
| **Privileged Groups**     | Detects if the user is part of critical groups (`Administrators`, `Domain Admins`, etc.). |
| **Service Path Issues**   | Finds unquoted service paths vulnerable to hijacking.                      |
| **Scheduled Tasks**       | Detects high-privileged tasks and writable task folders.                   |
| **Registry Permissions**  | Identifies writable registry keys in sensitive locations.                  |
| **Autorun Locations**     | Finds writable startup folders and autorun locations.                      |
| **DLL Hijacking**         | Identifies writable directories in PATH and Program Files.                 |
| **Network Configuration** | Checks open shares, listening ports, and firewall status.                  |
| **Installed Software**    | Audits software for known vulnerable applications (e.g., Flash, Java).     |
| **Windows Version**       | Extracts OS version, install date, and hotfix information.                 |
| **Drive Access**          | Checks write access to drive roots and common folders.                     |

---

## 🧪 Platform Testing

- ✅ **Linux** tested on: Ubuntu 22.04, Kali Linux, Debian 12.
- ✅ **Windows** tested on: Windows 10 Pro (21H2), Windows Server 2019, Windows 11.

> Each version outputs a structured JSON report grouped by severity (`info`, `medium`, `high`, `critical`).

---

## 📤 Output Example – Linux Report

> This section shows a sample Linux report generated by the `priv_esc` command. It groups findings by severity, includes timestamps, and summarizes the results.

```
[HIGH] FINDINGS:
Check: privileged groups
Result: User in privileged groups: sudo, adm
...

[MEDIUM] FINDINGS:
Check: suid sgid binaries
Result: SGID binary: /usr/bin/crontab
...

[INFO] FINDINGS:
Check: system info
Result: User: mydesktop, UID: 1000
...
```

---


